<?xml version="1.0" encoding="UTF-8"?>
<!--
Epic Walkthrough Template (v5.0)
Comprehensive post-epic documentation for knowledge transfer and retrospective
Generated by: /finalize command at epic completion
Purpose: Capture what happened, what worked, what struggled, lessons learned
-->

<walkthrough>
  <metadata>
    <epic_number>{{EPIC_NUMBER}}</epic_number>
    <epic_slug>{{EPIC_SLUG}}</epic_slug>
    <epic_title>{{EPIC_TITLE}}</epic_title>
    <generated>{{GENERATED_TIMESTAMP}}</generated>
    <workflow_version>5.0</workflow_version>
  </metadata>

  <overview>
    <epic_goal>
      {{EPIC_GOAL}}
      <!-- Restate the original objective from epic-spec.xml -->
    </epic_goal>

    <business_value_delivered>
      {{BUSINESS_VALUE}}
      <!-- What was actually delivered vs what was planned -->
      <!-- Example: "Enabled OAuth authentication for 3 providers (Google, GitHub, Microsoft)" -->
    </business_value_delivered>

    <duration>
      <start_date>{{START_DATE}}</start_date>
      <end_date>{{END_DATE}}</end_date>
      <total_calendar_days>{{CALENDAR_DAYS}}</total_calendar_days>
      <total_work_hours>{{WORK_HOURS}}</total_work_hours>
      <original_estimate_hours>{{ESTIMATED_HOURS}}</original_estimate_hours>
      <variance_hours>{{VARIANCE}}</variance_hours> <!-- positive = over estimate, negative = under -->
      <variance_percent>{{VARIANCE_PERCENT}}</variance_percent>
    </duration>

    <velocity_metrics>
      <expected_multiplier>{{EXPECTED_VELOCITY}}</expected_multiplier> <!-- e.g., 3.0x -->
      <actual_multiplier>{{ACTUAL_VELOCITY}}</actual_multiplier>
      <calculation_method>{{CALCULATION}}</calculation_method>
      <!-- Example: "Sequential would take 48h, parallel took 12h = 4x speedup" -->
      <factors>
        <factor type="positive">{{POSITIVE_FACTOR}}</factor>
        <!-- Example: "S02 and S03 ran 80% in parallel" -->
        <factor type="negative">{{NEGATIVE_FACTOR}}</factor>
        <!-- Example: "S01 took 2x longer than estimated due to OAuth complexity" -->
      </factors>
    </velocity_metrics>

    <team>
      <contributors>
        {{#CONTRIBUTORS}}
        <contributor role="{{ROLE}}">
          <name>{{NAME}}</name>
          <contribution>{{CONTRIBUTION}}</contribution>
        </contributor>
        {{/CONTRIBUTORS}}
      </contributors>
    </team>
  </overview>

  <phases_completed>
    {{#PHASES}}
    <phase name="{{PHASE_NAME}}" order="{{ORDER}}">
      <metadata>
        <status>{{STATUS}}</status> <!-- completed | skipped | failed_then_fixed -->
        <duration_hours>{{DURATION}}</duration_hours>
        <start_timestamp>{{START}}</start_timestamp>
        <end_timestamp>{{END}}</end_timestamp>
      </metadata>

      <key_deliverables>
        {{#DELIVERABLES}}
        <deliverable type="{{TYPE}}">
          {{DELIVERABLE_DESCRIPTION}}
        </deliverable>
        {{/DELIVERABLES}}
      </key_deliverables>

      <key_findings>
        {{KEY_FINDINGS}}
        <!-- Phase-specific insights discovered -->
        <!-- Example (research): "OAuth 2.1 eliminates implicit flow, PKCE required for all clients" -->
        <!-- Example (planning): "PostgreSQL sessions table better than Redis for < 10k users" -->
      </key_findings>

      <key_decisions>
        {{#DECISIONS}}
        <decision id="{{DECISION_ID}}">
          <question>{{QUESTION}}</question>
          <chosen_option>{{CHOSEN}}</chosen_option>
          <alternatives_considered>{{ALTERNATIVES}}</alternatives_considered>
          <rationale>{{RATIONALE}}</rationale>
          <outcome>{{OUTCOME}}</outcome> <!-- positive | neutral | negative | unknown -->
        </decision>
        {{/DECISIONS}}
      </key_decisions>

      <artifacts_produced>
        {{#ARTIFACTS}}
        <artifact path="{{PATH}}" type="{{TYPE}}">
          <!-- type: specification | plan | code | test | documentation | contract -->
          <description>{{DESCRIPTION}}</description>
          <lines_of_code>{{LOC}}</lines_of_code> <!-- if applicable -->
        </artifact>
        {{/ARTIFACTS}}
      </artifacts_produced>

      <challenges_encountered>
        {{#CHALLENGES}}
        <challenge severity="{{SEVERITY}}">
          <!-- severity: minor | moderate | major | blocking -->
          <description>{{DESCRIPTION}}</description>
          <resolution>{{RESOLUTION}}</resolution>
          <time_lost_hours>{{TIME_LOST}}</time_lost_hours>
        </challenge>
        {{/CHALLENGES}}
      </challenges_encountered>

      <phase_specific_metrics>
        <!-- Metrics unique to this phase -->
        {{PHASE_METRICS}}
        <!-- Example (implement): "Test coverage: 94%, 127 tests added, 0 flaky tests" -->
        <!-- Example (optimize): "Performance: p95 latency 67ms (target: <200ms)" -->
      </phase_specific_metrics>
    </phase>
    {{/PHASES}}
  </phases_completed>

  <sprints_summary>
    <!-- Sprint-level execution details -->
    {{#SPRINTS}}
    <sprint id="{{SPRINT_ID}}" name="{{SPRINT_NAME}}">
      <execution>
        <layer>{{LAYER}}</layer>
        <status>{{STATUS}}</status> <!-- completed | partial | blocked -->
        <duration_hours>{{DURATION}}</duration_hours>
        <ran_parallel_with>{{PARALLEL_SPRINT_IDS}}</ran_parallel_with>
        <actual_speedup>{{SPEEDUP}}</actual_speedup> <!-- vs sequential -->
      </execution>

      <outcomes>
        <tasks_completed>{{TASKS_DONE}}</tasks_completed>
        <tasks_total>{{TASKS_TOTAL}}</tasks_total>
        <acceptance_criteria_met>{{CRITERIA_MET}}</acceptance_criteria_met>
        <acceptance_criteria_total>{{CRITERIA_TOTAL}}</acceptance_criteria_total>
      </outcomes>

      <quality_metrics>
        <tests_added>{{TESTS_ADDED}}</tests_added>
        <test_coverage_percent>{{COVERAGE}}</test_coverage_percent>
        <bugs_found_in_sprint>{{BUGS}}</bugs_found_in_sprint>
        <technical_debt_added>{{DEBT}}</technical_debt_added> <!-- low | medium | high -->
      </quality_metrics>

      <integration>
        <consumed_contracts>{{CONTRACTS_CONSUMED}}</consumed_contracts>
        <produced_contracts>{{CONTRACTS_PRODUCED}}</produced_contracts>
        <integration_issues>{{INTEGRATION_ISSUES}}</integration_issues>
      </integration>
    </sprint>
    {{/SPRINTS}}
  </sprints_summary>

  <validation>
    <quality_gates>
      {{#GATES}}
      <gate name="{{GATE_NAME}}" category="{{CATEGORY}}">
        <!-- category: testing | security | performance | accessibility | code_quality -->
        <status>{{STATUS}}</status> <!-- passed | failed | waived | not_applicable -->
        <metrics>
          {{#METRICS}}
          <metric name="{{METRIC_NAME}}" value="{{VALUE}}" target="{{TARGET}}" status="{{STATUS}}">
            {{METRIC_DESCRIPTION}}
          </metric>
          {{/METRICS}}
        </metrics>
        <details>{{DETAILS}}</details>
      </gate>
      {{/GATES}}
    </quality_gates>

    <deployment_validation>
      <environments>
        {{#ENVIRONMENTS}}
        <environment name="{{ENV_NAME}}">
          <deployed_version>{{VERSION}}</deployed_version>
          <deployment_timestamp>{{TIMESTAMP}}</deployment_timestamp>
          <validation_status>{{STATUS}}</validation_status>
          <validation_tests_run>{{TESTS_RUN}}</validation_tests_run>
          <validation_tests_passed>{{TESTS_PASSED}}</validation_tests_passed>
          <issues_found>
            {{#ISSUES}}
            <issue severity="{{SEVERITY}}">{{DESCRIPTION}}</issue>
            {{/ISSUES}}
          </issues_found>
          <rollback_tested>{{ROLLBACK_TESTED}}</rollback_tested> <!-- true | false -->
        </environment>
        {{/ENVIRONMENTS}}
      </environments>
    </deployment_validation>

    <user_acceptance>
      <!-- If manual UAT was performed -->
      <tested>{{UAT_PERFORMED}}</tested>
      {{#UAT_FEEDBACK}}
      <feedback source="{{SOURCE}}" sentiment="{{SENTIMENT}}">
        {{FEEDBACK_TEXT}}
      </feedback>
      {{/UAT_FEEDBACK}}
    </user_acceptance>
  </validation>

  <key_files_modified>
    {{#CATEGORIES}}
    <category name="{{CATEGORY_NAME}}">
      <!-- category: backend | frontend | database | infrastructure | testing | documentation -->
      <files_count>{{FILE_COUNT}}</files_count>
      <lines_added>{{LINES_ADDED}}</lines_added>
      <lines_deleted>{{LINES_DELETED}}</lines_deleted>
      <net_change>{{NET_CHANGE}}</net_change>

      {{#FILES}}
      <file path="{{FILE_PATH}}" change_type="{{CHANGE_TYPE}}">
        <!-- change_type: created | modified | deleted | renamed -->
        <description>{{CHANGE_DESCRIPTION}}</description>
        <rationale>{{WHY_CHANGED}}</rationale>
        <risk_level>{{RISK}}</risk_level> <!-- low | medium | high -->
      </file>
      {{/FILES}}
    </category>
    {{/CATEGORIES}}
  </key_files_modified>

  <next_steps>
    <future_enhancements>
      {{#ENHANCEMENTS}}
      <enhancement priority="{{PRIORITY}}" effort="{{EFFORT}}">
        <!-- priority: critical | high | medium | low -->
        <!-- effort: small | medium | large -->
        <description>{{DESCRIPTION}}</description>
        <business_value>{{BUSINESS_VALUE}}</business_value>
        <dependencies>{{DEPENDENCIES}}</dependencies>
        <estimated_sprints>{{SPRINTS}}</estimated_sprints>
      </enhancement>
      {{/ENHANCEMENTS}}
    </future_enhancements>

    <technical_debt>
      {{#DEBT_ITEMS}}
      <debt_item severity="{{SEVERITY}}" category="{{CATEGORY}}">
        <!-- severity: low | medium | high | critical -->
        <!-- category: architecture | code_quality | testing | documentation | performance | security -->
        <description>{{DESCRIPTION}}</description>
        <location>{{FILE_PATHS}}</location>
        <why_incurred>{{REASON}}</why_incurred>
        <recommended_resolution>{{RESOLUTION}}</recommended_resolution>
        <estimated_effort_hours>{{EFFORT}}</estimated_effort_hours>
      </debt_item>
      {{/DEBT_ITEMS}}
    </technical_debt>

    <monitoring_recommendations>
      {{#MONITORING}}
      <recommendation type="{{TYPE}}">
        <!-- type: metric | alert | dashboard | log -->
        <description>{{DESCRIPTION}}</description>
        <threshold>{{THRESHOLD}}</threshold>
        <action_on_trigger>{{ACTION}}</action_on_trigger>
        <priority>{{PRIORITY}}</priority>
      </recommendation>
      {{/MONITORING}}
    </monitoring_recommendations>

    <follow_up_epics>
      <!-- Epics that should be created based on this epic -->
      {{#FOLLOW_UPS}}
      <epic_suggestion>
        <title>{{TITLE}}</title>
        <description>{{DESCRIPTION}}</description>
        <dependencies>{{DEPENDENCIES}}</dependencies>
        <priority>{{PRIORITY}}</priority>
      </epic_suggestion>
      {{/FOLLOW_UPS}}
    </follow_up_epics>
  </next_steps>

  <summary>
    <what_worked>
      {{#SUCCESSES}}
      <success category="{{CATEGORY}}">
        <!-- category: process | tooling | collaboration | technical | planning -->
        <description>{{DESCRIPTION}}</description>
        <impact>{{IMPACT}}</impact>
        <should_repeat>{{REPEAT}}</should_repeat> <!-- true | false -->
        <applicable_to_future_epics>{{APPLICABLE}}</applicable_to_future_epics>
      </success>
      {{/SUCCESSES}}
    </what_worked>

    <what_struggled>
      {{#STRUGGLES}}
      <struggle category="{{CATEGORY}}" severity="{{SEVERITY}}">
        <description>{{DESCRIPTION}}</description>
        <root_cause>{{ROOT_CAUSE}}</root_cause>
        <impact_on_timeline>{{IMPACT}}</impact_on_timeline>
        <could_have_been_avoided>{{AVOIDABLE}}</could_have_been_avoided>
        <prevention_strategy>{{PREVENTION}}</prevention_strategy>
      </struggle>
      {{/STRUGGLES}}
    </what_struggled>

    <lessons_learned>
      {{#LESSONS}}
      <lesson category="{{CATEGORY}}" confidence="{{CONFIDENCE}}">
        <!-- confidence: low | medium | high -->
        <statement>{{LESSON_STATEMENT}}</statement>
        <evidence>{{EVIDENCE}}</evidence>
        <actionable_change>{{ACTION}}</actionable_change>
        <applies_to>{{SCOPE}}</applies_to> <!-- this_project | all_projects | specific_domain -->
      </lesson>
      {{/LESSONS}}
    </lessons_learned>

    <velocity_impact>
      <expected_multiplier>{{EXPECTED}}</expected_multiplier>
      <actual_multiplier>{{ACTUAL}}</actual_multiplier>
      <variance>{{VARIANCE}}</variance> <!-- positive = exceeded expectations -->
      <primary_accelerators>
        {{#ACCELERATORS}}
        <accelerator>{{DESCRIPTION}}</accelerator>
        {{/ACCELERATORS}}
      </primary_accelerators>
      <primary_decelerators>
        {{#DECELERATORS}}
        <decelerator>{{DESCRIPTION}}</decelerator>
        {{/DECELERATORS}}
      </primary_decelerators>
      <recommendation_for_next_epic>{{RECOMMENDATION}}</recommendation_for_next_epic>
    </velocity_impact>

    <workflow_effectiveness>
      <!-- Self-assessment of workflow system performance -->
      <phases_that_worked_well>{{PHASES_GOOD}}</phases_that_worked_well>
      <phases_that_need_improvement>{{PHASES_BAD}}</phases_that_need_improvement>
      <suggested_workflow_changes>
        {{#WORKFLOW_SUGGESTIONS}}
        <suggestion type="{{TYPE}}" priority="{{PRIORITY}}">
          <!-- type: add_phase | remove_phase | modify_phase | change_gate | improve_tooling -->
          <description>{{DESCRIPTION}}</description>
          <expected_benefit>{{BENEFIT}}</expected_benefit>
          <implementation_effort>{{EFFORT}}</implementation_effort>
        </suggestion>
        {{/WORKFLOW_SUGGESTIONS}}
      </suggested_workflow_changes>
    </workflow_effectiveness>

    <key_metrics_summary>
      <!-- High-level metrics for executive summary -->
      <metric name="sprints_completed" value="{{SPRINTS}}" />
      <metric name="total_tasks_completed" value="{{TASKS}}" />
      <metric name="test_coverage_percent" value="{{COVERAGE}}" />
      <metric name="bugs_found_total" value="{{BUGS}}" />
      <metric name="deployment_success_rate" value="{{DEPLOY_SUCCESS}}" />
      <metric name="velocity_multiplier" value="{{VELOCITY}}" />
      <metric name="quality_gates_passed" value="{{GATES_PASSED}}" />
      <metric name="technical_debt_added" value="{{DEBT_ADDED}}" />
    </key_metrics_summary>
  </summary>

  <references>
    <!-- Links to key artifacts for this epic -->
    <artifact type="specification" path="{{SPEC_PATH}}" />
    <artifact type="research" path="{{RESEARCH_PATH}}" />
    <artifact type="plan" path="{{PLAN_PATH}}" />
    <artifact type="sprint_plan" path="{{SPRINT_PLAN_PATH}}" />
    <artifact type="tasks" path="{{TASKS_PATH}}" />
    <artifact type="workflow_state" path="{{WORKFLOW_STATE_PATH}}" />
    {{#OTHER_ARTIFACTS}}
    <artifact type="{{TYPE}}" path="{{PATH}}" />
    {{/OTHER_ARTIFACTS}}
  </references>
</walkthrough>
